!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("http"),require("https"),require("zlib"),require("url"),require("net"),require("util")):"function"==typeof define&&define.amd?define(["http","https","zlib","url","net","util"],t):"object"==typeof exports?exports.HttpRequestMock=t(require("http"),require("https"),require("zlib"),require("url"),require("net"),require("util")):e.HttpRequestMock=t(e.http,e.https,e.zlib,e.url,e.net,e.util)}(self,(function(e,t,n,r,o,s){return(()=>{"use strict";var i={176:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){this.flag="yes"}},571:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFullRequestUrl=t.isNodejs=t.currentDatetime=t.currentTime=t.currentDate=t.isArrayBuffer=t.str2arrayBuffer=t.sleep=t.tryToParseObject=t.isObject=t.getQuery=void 0,t.getQuery=function(e){return/\?/.test(e)?e.replace(/.*?\?/g,"").replace(/#.*$/g,"").split("&").reduce((function(e,t){var n=t.split("="),r=n[0],o=n[1];return e[r]=(o||"").trim(),e}),{}):{}},t.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},t.tryToParseObject=function(e){if("string"!=typeof e||"{"!==e[0]||"}"!==e[e.length-1])return e;try{return JSON.parse(e)}catch(t){return e}},t.sleep=function(e){return new Promise((function(t){return setTimeout(t,e)}))},t.str2arrayBuffer=function(e){if("function"==typeof TextEncoder)return(new TextEncoder).encode(e);for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t},t.isArrayBuffer=function(e){return"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"function"==typeof Int32Array&&e instanceof Int32Array||"function"==typeof Int16Array&&e instanceof Int16Array||"function"==typeof Int8Array&&e instanceof Int8Array},t.currentDate=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),o=function(e){return e<10?"0".concat(e):"".concat(e)};return"".concat(o(t),"-").concat(o(n),"-").concat(o(r))},t.currentTime=function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),r=e.getSeconds(),o=function(e){return e<10?"0".concat(e):"".concat(e)};return"".concat(o(t),":").concat(o(n),":").concat(o(r))},t.currentDatetime=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),o=e.getHours(),s=e.getMinutes(),i=e.getSeconds(),u=function(e){return e<10?"0".concat(e):"".concat(e)};return"".concat(u(t),"-").concat(u(n),"-").concat(u(r)," ").concat(u(o),":").concat(u(s),":").concat(u(i))},t.isNodejs=function(){return"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)&&!(!process.versions||!process.versions.node)},t.getFullRequestUrl=function(e){if(/^https?:\/\//i.test(e)||/^\/\//.test(e))return e;if("function"==typeof URL&&"object"==typeof window&&window)return new URL(e,window.location.href).href;if("object"==typeof document&&document&&"function"==typeof document.createElement){var t=document.createElement("a");return t.href=e,t.href}return e}},913:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HTTPStatusCodes=void 0,t.HTTPStatusCodes={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a Teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},473:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=u(n(140)),c=u(n(799)),f=i(n(638));t.default=function(e,t,n,o,s){return void 0===s&&(s={}),new Promise((function(i,u){var l=function(e){return"string"==typeof e?/^https:/i.test(e):!(!e||!e.href&&!e.protocol)&&(/^https:/i.test(e.href)||"https:"===String(e.protocol).toLowerCase())}(e),p=l?c.default:a.default,d=r({useNativeModule:!0,method:(t||"GET").toUpperCase(),headers:n||{}},s),h=p.request(e,d,(function(e){(function(e){var t="gzip"===e.headers["content-encoding"]?e.pipe(f.createGunzip()):e;return new Promise((function(e,n){t.once("error",(function(e){t.removeAllListeners(),n(e)}));var r="";t.on("data",(function(e){return r+=e})),t.once("end",(function(){e(r),t.removeAllListeners()}))}))})(e).then((function(t){i({body:t,response:e})})).catch((function(e){h.emit("error",e)}))}));h.on("error",(function(e){u(e)})),o&&("string"==typeof o||o instanceof Buffer||o instanceof ArrayBuffer||o instanceof SharedArrayBuffer||o instanceof Uint8Array?h.write(Buffer.from(o)):h.write(Buffer.from(JSON.stringify(o)))),h.end()}))}},507:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(571),i=n(913),u=o(n(473));t.default=function(e,t){var n,o;return"object"==typeof e?(n=e.url,o=e):(n=e,o=t||{}),(0,u.default)(n,o.method,o.headers,o.body).then((function(e){return function(e,t,n){var o=t,u=n.statusCode||200,a=i.HTTPStatusCodes[u]||"",c=n.headers,f="function"==typeof Headers?new Headers(r(r({},c),{"x-powered-by":"http-request-mock"})):r(r({},c),{"x-powered-by":"http-request-mock"}),l="function"==typeof Blob?new Blob(["string"==typeof o?o:JSON.stringify(o)]):o;if("function"==typeof Response){var p=new Response(l,{status:u,statusText:a,headers:f});return Object.defineProperty(p,"url",{value:e}),p}var d={body:l,bodyUsed:!1,headers:f,ok:!0,redirected:!1,status:u,statusText:a,url:e,type:"basic",json:function(){return Promise.resolve(o)},arrayBuffer:function(){return(0,s.isArrayBuffer)(o)?Promise.resolve(o):Promise.resolve((0,s.str2arrayBuffer)("string"==typeof o?o:JSON.stringify(o)))},blob:function(){return Promise.resolve(l)},formData:function(){return Promise.resolve(o)},text:function(){return Promise.resolve("string"==typeof o?o:JSON.stringify(o))},clone:function(){return d},error:function(){return d},redirect:function(){return d}};return d}(n,e.body,e.response)}))}},295:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(571),i=o(n(473));t.default=function(e){var t=e.url,n=e.method,o=e.data,u=e.header,a=e.dataType,c=e.responseType,f=e.success,l=e.fail,p=e.complete,d=o&&"GET"!==(n+"").toUpperCase()?o:null;return(0,i.default)(t,n,u,d).then((function(e){var t;if("function"==typeof f){var n;if("json"===a){if("object"==typeof e.body)n=e.body;else if("string"==typeof e.body)try{n=JSON.parse(e.body)}catch(e){throw e.message="res.body is not a json-like string.",e}}else"text"===c?n="string"==typeof e.body?e.body:JSON.stringify(e.body):"arraybuffer"===c&&(n=(0,s.isArrayBuffer)(e.body)?e.body:(0,s.str2arrayBuffer)("string"==typeof e.body?e.body:JSON.stringify(e.body)));f({data:n,statusCode:e.response.statusCode,header:r({},e.response.headers),cookies:(null===(t=e.response.headers)||void 0===t?void 0:t["set-cookie"])||[],profile:{}})}"function"==typeof p&&p()})).catch((function(e){"function"==typeof l&&l(e),"function"==typeof p&&p()})),{abort:function(){}}}},493:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(571),i=o(n(473)),u=function(){function e(){this.requestArgs=[],this.reqHeaders={},this._responseHeaders={},this._responseBody="",this.responseType="",this._readyState=0,this._status=0,this._statusText=""}return e.prototype.open=function(e,t,n,r,o){void 0===n&&(n=!0),void 0===r&&(r=null),void 0===o&&(o=null),this.requestArgs=[e,t,n,r,o],this._readyState=1},e.prototype.send=function(e){var t=this,n=this.requestArgs,r=n[0],o=n[1],s=n[2],u=n[3],a=s&&u?{auth:"".concat(s,":").concat(u)}:{};(0,i.default)(o,r,this.reqHeaders,e,a).then((function(e){t._responseBody=e.body,t._readyState=4,t._status=e.response.statusCode,t._statusText=e.response.statusMessage,t._responseHeaders=e.response.headers||{},t.sendResult(t)})).catch((function(e){if(t._status=0,"function"!=typeof t.onerror)throw e;t.onerror(e)}))},e.prototype.abort=function(){this._status=0,this._readyState=0,this._responseBody=""},e.prototype.setRequestHeader=function(e,t){this.reqHeaders[e]=t},e.prototype.sendResult=function(e){var t="undefined"!=typeof Event&&"function"==typeof e.dispatchEvent;"function"==typeof e.onreadystatechange?e.onreadystatechange(this.event("readystatechange")):t&&e.dispatchEvent(new Event("readystatechange")),"function"==typeof e.onload?e.onload(this.event("load")):t&&e.dispatchEvent(new Event("load")),"function"==typeof e.onloadend?e.onloadend(this.event("loadend")):t&&e.dispatchEvent(new Event("loadend"))},e.prototype.event=function(e){return{type:e,target:null,currentTarget:null,eventPhase:0,bubbles:!1,cancelable:!1,defaultPrevented:!1,composed:!1,timeStamp:294973.8000000119,srcElement:null,returnValue:!0,cancelBubble:!1,path:[],NONE:0,CAPTURING_PHASE:0,AT_TARGET:0,BUBBLING_PHASE:0,composedPath:function(){return[]},initEvent:function(){},preventDefault:function(){},stopImmediatePropagation:function(){},stopPropagation:function(){},isTrusted:!1,lengthComputable:!1,loaded:1,total:1}},e.prototype.getAllResponseHeaders=function(){return Object.entries(r({},this._responseHeaders)).map((function(e){var t=e[0],n=e[1];return t.toLowerCase()+": "+n})).join("\r\n")},e.prototype.getResponseHeader=function(e){return void 0===this._responseHeaders[e]?null:this._responseHeaders[e]},Object.defineProperty(e.prototype,"readyState",{get:function(){return this._readyState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statusText",{get:function(){return this._statusText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"response",{get:function(){var e=this.responseType;if("text"===e||""===e)return this.responseText;if("arraybuffer"===e)return(0,s.isArrayBuffer)(this._responseBody)?this._responseBody:"string"==typeof this._responseBody?(0,s.str2arrayBuffer)(this._responseBody):(0,s.str2arrayBuffer)(JSON.stringify(this._responseBody));if("json"===e&&"string"==typeof this._responseBody)try{return JSON.parse(this._responseBody)}catch(e){return null}return this._responseBody},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"responseText",{get:function(){return"string"==typeof this._responseBody?this._responseBody:JSON.stringify(this._responseBody)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"responseURL",{get:function(){return this.requestArgs[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"responseXML",{get:function(){return null},enumerable:!1,configurable:!0}),e}();t.default=u},607:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(571),s=r(n(843)),i=r(n(556)),u=r(n(427)),a=r(n(755)),c=function(){function e(){}return e.setup=function(){var e=new a.default;return"undefined"!=typeof wx&&"function"==typeof wx.request&&i.default.setup(e),"undefined"!=typeof window&&"function"==typeof window.XMLHttpRequest&&u.default.setup(e),"undefined"!=typeof window&&"function"==typeof window.fetch&&s.default.setup(e),(0,o.isNodejs)()&&n(743).default.setup(e),e},e.setupForWx=function(){var e=new a.default;return i.default.setup(e),e},e.setupForXhr=function(){var e=new a.default;return u.default.setup(e),e},e.setupForFetch=function(){var e=new a.default;return s.default.setup(e),e},e.setupForNode=function(){var e=new a.default;return n(743).default.setup(e),e},e.enable=function(){return a.default.getInstance().enable()},e.disable=function(){return a.default.getInstance().disable()},e.enableLog=function(){return a.default.getInstance().enableLog()},e.disableLog=function(){return a.default.getInstance().disableLog()},e.setupForUnitTest=function(e){if(!(0,o.isNodejs)())throw new Error('"setupForUnitTest" is only for nodejs envrioment.');var t=new a.default;return"wx"===e&&i.default.setupForUnitTest(t),"xhr"===e&&u.default.setupForUnitTest(t),"fetch"===e&&s.default.setupForUnitTest(t),"node"!==e&&"node.http.request"!==e||n(743).default.setupForUnitTest(t),"all"===e&&(i.default.setupForUnitTest(t),u.default.setupForUnitTest(t),s.default.setupForUnitTest(t),n(743).default.setupForUnitTest(t)),t},e.default=e,e}();t.default=c,e.exports=c},985:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(571),o=function(){function e(t){this.mocker=t,this.global=e.getGlobal()}return e.setup=function(e){return new this(e)},e.getGlobal=function(){if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Detect global variable error")},e.prototype.matchMockRequest=function(e,t){var n=this.mocker.matchMockItem(e,t);return n&&void 0!==n.times&&(n.times-=1),n},e.prototype.getRequestInfo=function(e){var t={url:e.url,method:e.method||"GET",query:(0,r.getQuery)(e.url)};return(e.headers||e.header)&&(t.headers=e.headers||e.header),void 0!==e.body&&(t.body=(0,r.tryToParseObject)(e.body)),t},e}();t.default=o},843:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,u)}a((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(n(176)),f=n(571),l=n(913),p=a(n(985)),d=function(e){function t(n){var r=e.call(this,n)||this;return t.instance?t.instance:(t.instance=r,r.fetch=r.global.fetch.bind(r.global),r.intercept(),r)}return o(t,e),t.setupForUnitTest=function(e){var r=p.default.getGlobal();return r.fetch||(r.fetch=n(507).default),new t(e)},t.prototype.intercept=function(){var e=this;return this.global.fetch=function(t,n){var r,o;"object"==typeof t?(r=t.url,o=t):(r=t,o=n||{});var i=(0,f.getFullRequestUrl)(r),u=o&&o.method?o.method:"GET";return new Promise((function(t,n){var a=e.matchMockRequest(i,u);if(a){var c=e.getRequestInfo(s({url:i,method:u},o));e.doMockRequest(a,c,t).then((function(s){s&&e.fetch(r,o).then(t).catch(n)}))}else e.fetch(r,o).then(t).catch(n)}))},this},t.prototype.doMockRequest=function(e,t,n){return i(this,void 0,void 0,(function(){var r;return u(this,(function(o){switch(o.label){case 0:return r=!1,e.delay&&e.delay>0?[4,(0,f.sleep)(+e.delay)]:[3,3];case 1:return o.sent(),[4,this.doMockResponse(e,t,n)];case 2:return r=o.sent(),[3,5];case 3:return[4,this.doMockResponse(e,t,n)];case 4:r=o.sent(),o.label=5;case 5:return[2,r]}}))}))},t.prototype.doMockResponse=function(e,t,n){return i(this,void 0,void 0,(function(){var r,o,s;return u(this,(function(i){switch(i.label){case 0:return[4,e.sendBody(t)];case 1:return r=i.sent(),o=Date.now(),r instanceof c.default?[2,!0]:(s=Date.now()-o+(e.delay||0),this.mocker.sendResponseLog(s,r,t,e),n(this.getFetchResponse(r,e,t)),[2,!1])}}))}))},t.prototype.getFetchResponse=function(e,t,n){var r=e,o=t.status,i=l.HTTPStatusCodes[o]||"",u="function"==typeof Headers?new Headers(s(s({},t.header),{"x-powered-by":"http-request-mock"})):s(s({},t.header),{"x-powered-by":"http-request-mock"}),a="function"==typeof Blob?new Blob(["string"==typeof r?r:JSON.stringify(r)]):r;if("function"==typeof Response){var c=new Response(a,{status:o,statusText:i,headers:u});return Object.defineProperty(c,"url",{value:n.url}),c}var f={body:a,bodyUsed:!1,headers:u,ok:!0,redirected:!1,status:o,statusText:i,url:n.url,type:"basic",json:function(){return Promise.resolve(r)},arrayBuffer:function(){return Promise.resolve(r)},blob:function(){return Promise.resolve(a)},formData:function(){return Promise.resolve(r)},text:function(){return Promise.resolve("string"==typeof r?r:JSON.stringify(r))},clone:function(){return f},error:function(){return f},redirect:function(){return f}};return f},t}(p.default);t.default=d},417:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,s=t.length;o<s;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(140)),u=n(548),a=n(269),c=s(n(176)),f=n(571),l=n(913);function p(e,t,n){var s=this;i.default.OutgoingMessage.call(this),this.requestBody=Buffer.alloc(0),this.url=e,this.options=t,this.callback=n,this.nativeInstance=null,this.init=function(){var e,t=[s.options,s.callback],n=t[0],r=t[1];if(s.method=n.method||"GET",s.path=n.path||"/",r&&s.once("response",r),!s.headersSent&&n.headers)for(var o in n.headers)s.setHeader(o,n.headers[o]);s.socket=new u.Socket,s.connection=s.socket,/^https/i.test(s.url)&&(s.socket.authorized=!0),n.timeout&&(s.setTimeout(n.timeout),s.socket.setTimeout(n.timeout)),process.nextTick((function(){var e;s.emit("socket",s.socket),null===(e=s.socket)||void 0===e||e.emit("connect")})),"100-continue"===(null===(e=n.headers)||void 0===e?void 0:e.expect)&&s.emit("continue"),s.response=new i.default.IncomingMessage(s.socket)},this.init(),this.setMockItemResolver=function(e){return s.mockItemResolver=e,s},this.setOriginalRequestInfo=function(e,t){s.nativeReqestMethod=e,s.nativeRequestArgs=t},this.destroy=function(){if(!s.aborted&&!s.destroyed){s.aborted=!0,s.destroyed=!0;var e=r(r({},new Error),{code:"aborted"});return s.response.emit("close",e),s.emit("abort"),s}},this.abort=function(){return s.destroy(),s},this.sendError=function(e){process.nextTick((function(){s.emit("error",new Error(e))}))},this.write=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if("string"!=typeof e&&!Buffer.isBuffer(e))return s.sendError("The first argument must be of type string or an instance of Buffer."),!1;var r="function"==typeof t[1]?t[1]:t[2];if(s.aborted||s.destroyed)s.sendError("The request has been aborted.");else{if(e.length){var o=Buffer.isBuffer(e)?e:Buffer.from(e);s.requestBody=Buffer.concat([s.requestBody,o])}e.length&&"function"==typeof r&&r()}return setTimeout((function(){return s.emit("drain")}),1),!1},this.end=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=s.getEndArguments(e),r=n[0],i=n[1],u=n[2];return r?(s.write(r,i),s.end(u),s):s.response.complete?(s.sendEndingEvent(u),s):(s.sendResponseResult.apply(s,o([u],e,!1)),s)},this.sendResponseResult=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=Date.now();s.mockItemResolver((function(n,i){var u={url:s.url,method:s.options.method||"GET",query:(0,f.getQuery)(s.url),headers:s.getRequestHeaders(),body:s.bufferToString(s.requestBody)};n.sendBody(u).then((function(a){if(a instanceof c.default)return s.fallbackToNativeRequest.apply(s,t);var f=Date.now()-o;i.sendResponseLog(f,a,u,n),s.response.statusCode=n.status,s.response.statusMessage=l.HTTPStatusCodes[s.response.statusCode]||"",s.response.headers=r(r({},n.header),{"x-powered-by":"http-request-mock"}),s.response.rawHeaders=Object.entries(s.response.headers).reduce((function(e,t){return e.concat(t)}),[]),"string"==typeof a||a instanceof Buffer||a instanceof ArrayBuffer||a instanceof SharedArrayBuffer||a instanceof Uint8Array?s.response.push(Buffer.from(a)):s.response.push(JSON.stringify(a)),s.sendEndingEvent(e)}))}))},this.sendEndingEvent=function(e){return"function"==typeof e&&e(),s.finished=!0,s.emit("finish"),s.emit("response",s.response),s.response.push(null),s.response.complete=!0,s},this.fallbackToNativeRequest=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return s.nativeInstance=s.nativeReqestMethod.apply(s,s.nativeRequestArgs),Object.entries(s.getHeaders()).forEach((function(e){null!==e[1]&&void 0!==e[1]&&s.nativeInstance&&s.nativeInstance.setHeader(e[0],e[1])})),s.requestBody.length&&s.nativeInstance&&s.nativeInstance.write(s.requestBody),s.nativeInstance&&(s.nativeInstance.on("connect",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.emit.apply(s,o(["connect"],e,!1))})),s.nativeInstance.on("finish",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.emit.apply(s,o(["finish"],e,!1))})),s.nativeInstance.on("abort",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.emit.apply(s,o(["abort"],e,!1))})),s.nativeInstance.on("error",(function(e){return s.emit("error",e)})),s.nativeInstance.on("information",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.emit.apply(s,o(["information"],e,!1))})),s.nativeInstance.on("response",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.emit.apply(s,o(["response"],e,!1))})),s.nativeInstance.on("timeout",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.emit.apply(s,o(["timeout"],e,!1))})),(e=s.nativeInstance).end.apply(e,t)),s.nativeInstance},this.getEndArguments=function(e){var t,n,r;return 3===e.length?(t=e[0],n=e[1],r=e[2]):2===e.length?(t=e[0],n=e[1]):1===e.length&&(t="function"==typeof e[0]?void 0:e[0],r="function"==typeof e[0]?e[0]:void 0),[t,n,r]},this.bufferToString=function(e){var t=e.toString("utf8");return Buffer.from(t).equals(e)?t:e.toString("hex")},this.getRequestHeaders=function(){return Object.entries(r(r({},s.getHeaders()),s.options.headers)).reduce((function(e,t){var n=t[0],r=t[1];return null!=r&&(e[n.toLowerCase()]=Array.isArray(r)?r.join("; "):r+""),e}),{})}}(0,a.inherits)(p,i.default.ClientRequest),t.default=p},743:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(140)),u=s(n(799)),a=s(n(874)),c=n(571),f=s(n(985)),l=s(n(417)),p=function(e){function t(n){var r=e.call(this,n)||this;return t.instance?t.instance:(t.instance=r,r.httpRequest=i.default.request.bind(i.default),r.httpsRequest=u.default.request.bind(u.default),r.httpGet=i.default.get.bind(i.default),r.httpsGet=u.default.get.bind(u.default),r.intercept(),r)}return o(t,e),t.setupForUnitTest=function(e){if(!(0,c.isNodejs)())throw new Error("Not a nodejs envrioment.");return new t(e)},t.prototype.intercept=function(){this.inteceptRequestMethod(),this.inteceptGetMethod()},t.prototype.inteceptRequestMethod=function(){var e=this;i.default.request=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.getClientRequest(t);return r?(r.setOriginalRequestInfo(e.httpRequest,t),r):e.httpRequest.apply(e,t)},u.default.request=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.getClientRequest(t);return r?(r.setOriginalRequestInfo(e.httpsRequest,t),r):e.httpsRequest.apply(e,t)}},t.prototype.inteceptGetMethod=function(){var e=this;i.default.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.getClientRequest(t);return r?(r.setOriginalRequestInfo(e.httpGet,t),r.end(),r):e.httpGet.apply(e,t)},u.default.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.getClientRequest(t);return r?(r.setOriginalRequestInfo(e.httpsGet,t),r.end(),r):e.httpsGet.apply(e,t)}},t.prototype.getClientRequest=function(e){var t=this.getRequestArguments(e),n=t[0],r=t[1],o=t[2];if(r.useNativeModule)return delete r.useNativeModule,!1;var s=r.method||"GET",i=this.matchMockRequest(n,s);if(!i)return!1;var u=new l.default(n,r,o);return this.doMockRequest(u,i),u},t.prototype.doMockRequest=function(e,t){this.doMockResponse(e,t)},t.prototype.doMockResponse=function(e,t){var n=this;e.setMockItemResolver((function(e){t.delay&&t.delay>0?setTimeout((function(){return e(t,n.mocker)}),+t.delay):e(t,n.mocker)}))},t.prototype.getRequestArguments=function(e){var t,n,r;if(("string"==typeof e[0]||this.isUrlObject(e[0]))&&(t="string"==typeof e[0]?e[0]:e[0].href),(void 0===t||t&&(0,c.isObject)(e[1]))&&(n=void 0===t?e[0]:e[1]),"function"!=typeof e[1]&&"function"!=typeof e[2]||(r="function"==typeof e[1]?e[1]:e[2]),!t){var o=/^\d+$/.test(n.port)?":".concat(n.port):"",s=":443"===o||n.cert||/^https:/i.test(n.path),i=n.protocol?n.protocol:s?"https:":"http:",u=n.hostname||n.host||"localhost",a=n.path||"/",f=n.auth?n.auth+"@":"",l="".concat(i,"//").concat(f).concat(u).concat(o);t=n.uri?n.uri.href:new URL(a,l).href}return[t,n||{},r]},t.prototype.isUrlObject=function(e){return"[object URL]"===Object.prototype.toString.call(e)||e instanceof URL||e instanceof a.default.Url||(0,c.isObject)(e)&&"href"in e&&"hostname"in e&&!("method"in e)},t}(f.default);t.default=p},556:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,u)}a((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(n(176)),f=n(571),l=a(n(985)),p=function(e){function t(n){var r=e.call(this,n)||this;return t.instance?t.instance:(t.instance=r,r.wxRequest=wx.request.bind(wx),r.intercept(),r)}return o(t,e),t.setupForUnitTest=function(e){var r=l.default.getGlobal();return r.wx=r.wx||{},r.wx.request||(r.wx.request=n(295).default.bind(r.wx)),new t(e)},t.prototype.intercept=function(){var e=this;return Object.defineProperty(wx,"request",{configurable:!0,enumerable:!0,writable:!0,value:function(t){if(t&&t.url){t.url=(0,f.getFullRequestUrl)(t.url);var n=e.matchMockRequest(t.url,t.method),r=e.getRequestInfo(t);return/^get$/i.test(t.method)&&(0,f.isObject)(t.data)?r.query=s(s({},r.query),t.data):r.body=t.data,n?(e.doMockRequest(n,r,t).then((function(n){n&&e.wxRequest(t)})),e.getRequstTask()):e.wxRequest(t)}}}),this},t.prototype.getRequstTask=function(){return{abort:function(){},onHeadersReceived:function(){},offHeadersReceived:function(){}}},t.prototype.doMockRequest=function(e,t,n){return i(this,void 0,void 0,(function(){var r;return u(this,(function(o){switch(o.label){case 0:return r=!1,e.delay&&e.delay>0?[4,(0,f.sleep)(+e.delay)]:[3,3];case 1:return o.sent(),[4,this.doMockResponse(e,t,n)];case 2:return r=o.sent(),[3,5];case 3:return[4,this.doMockResponse(e,t,n)];case 4:r=o.sent(),o.label=5;case 5:return[2,r]}}))}))},t.prototype.doMockResponse=function(e,t,n){return i(this,void 0,void 0,(function(){var r,o,s,i;return u(this,(function(u){switch(u.label){case 0:return r=Date.now(),[4,e.sendBody(t)];case 1:return(o=u.sent())instanceof c.default?[2,!0]:(s=Date.now()-r+(e.delay||0),i=this.getWxResponse(o,e),this.mocker.sendResponseLog(s,o,t,e),this.sendResult(n,i),[2,!1])}}))}))},t.prototype.getWxResponse=function(e,t){var n,r=[].concat((null===(n=t.header)||void 0===n?void 0:n["set-cookie"])||[]);return{data:e,statusCode:t.status||200,header:s(s({},t.header),{"x-powered-by":"http-request-mock"}),cookies:r,profile:{}}},t.prototype.sendResult=function(e,t){"function"==typeof e.success&&e.success(t),"function"==typeof e.complete&&e.complete(t)},t}(l.default);t.default=p},427:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,u)}a((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(n(176)),f=n(571),l=n(913),p=function(e){function t(n){var r=e.call(this,n)||this;return t.instance?t.instance:(t.instance=r,r.xhr=r.global.XMLHttpRequest.prototype,r.intercept(),r)}return o(t,e),t.setupForUnitTest=function(e){return n.g.XMLHttpRequest=n.g.XMLHttpRequest||n(493).default,new t(e)},t.prototype.intercept=function(){return this.interceptOpen(),this.interceptSend(),this.interceptSetRequestHeader(),this.interceptGetAllResponseHeaders(),this.interceptGetResponseHeader(),this.interceptReadyState(),this.interceptStatus(),this.interceptStatusText(),this.interceptResponseText(),this.interceptResponse(),this.interceptResponseURL(),this.interceptResponseXML(),this},t.prototype.interceptOpen=function(){var e=this,t=this.xhr.open;return Object.defineProperty(this.xhr,"open",{get:function(){var n=this;return function(r,o,s,i,u){if(void 0===s&&(s=!0),void 0===i&&(i=null),void 0===u&&(u=null),!n.bypassMock){var a=(0,f.getFullRequestUrl)(o),c=e.matchMockRequest(a,r);if(c)return n.isMockRequest=!0,n.mockItem=c,n.mockResponse=new d,n.requestInfo=e.getRequestInfo({url:a,method:r}),void(n.requestArgs=[r,o,s,i,u])}return t.call(n,r,o,s,i,u)}}}),this},t.prototype.interceptSend=function(){var e=this,t=this.xhr.send;return Object.defineProperty(this.xhr,"send",{get:function(){var n=this;return function(r){return n.isMockRequest?(null!=r&&(n.requestInfo.body=(0,f.tryToParseObject)(r)),e.doMockRequest(n).then((function(e){if(e)return n.isMockRequest=!1,n.bypassMock=!0,n.open.apply(n,n.requestArgs),t.call(n,r)}))):t.call(n,r)}}}),this},t.prototype.doMockRequest=function(e){return i(this,void 0,void 0,(function(){var t,n;return u(this,(function(r){switch(r.label){case 0:return t=!1,(n=e.mockItem).delay&&n.delay>0?[4,(0,f.sleep)(+n.delay)]:[3,3];case 1:return r.sent(),[4,this.doMockResponse(e)];case 2:return t=r.sent(),[3,5];case 3:return[4,this.doMockResponse(e)];case 4:t=r.sent(),r.label=5;case 5:return[2,t]}}))}))},t.prototype.doMockResponse=function(e){return i(this,void 0,void 0,(function(){var t,n,r,o,s;return u(this,(function(i){switch(i.label){case 0:return t=e.mockItem,n=e.requestInfo,r=Date.now(),[4,t.sendBody(n)];case 1:return(o=i.sent())instanceof c.default?[2,!0]:(s=Date.now()-r+(t.delay||0),e.mockResponse=o,this.mocker.sendResponseLog(s,o,e.requestInfo,t),this.sendResult(e),[2,!1])}}))}))},t.prototype.sendResult=function(e){var t="undefined"!=typeof Event&&"function"==typeof e.dispatchEvent;"function"==typeof e.onreadystatechange?e.onreadystatechange(this.event("readystatechange")):t&&e.dispatchEvent(new Event("readystatechange")),"function"==typeof e.onload?e.onload(this.event("load")):t&&e.dispatchEvent(new Event("load")),"function"==typeof e.onloadend?e.onloadend(this.event("loadend")):t&&e.dispatchEvent(new Event("loadend"))},t.prototype.event=function(e){return{type:e,target:null,currentTarget:null,eventPhase:0,bubbles:!1,cancelable:!1,defaultPrevented:!1,composed:!1,timeStamp:294973.8000000119,srcElement:null,returnValue:!0,cancelBubble:!1,path:[],NONE:0,CAPTURING_PHASE:0,AT_TARGET:0,BUBBLING_PHASE:0,composedPath:function(){return[]},initEvent:function(){},preventDefault:function(){},stopImmediatePropagation:function(){},stopPropagation:function(){},isTrusted:!1,lengthComputable:!1,loaded:1,total:1}},t.prototype.interceptGetAllResponseHeaders=function(){var e=this.xhr.getAllResponseHeaders;return Object.defineProperty(this.xhr,"getAllResponseHeaders",{get:function(){var t=this;return function(){return t.isMockRequest?Object.entries(s(s({},t.mockItem.header),{"x-powered-by":"http-request-mock"})).map((function(e){var t=e[0],n=e[1];return t.toLowerCase()+": "+n})).join("\r\n"):e.call(t)}}}),this},t.prototype.interceptGetResponseHeader=function(){var e=this.xhr.getResponseHeader;return Object.defineProperty(this.xhr,"getResponseHeader",{get:function(){var t=this;return function(n){if(t.isMockRequest){if(/^x-powered-by$/i.test(n))return"http-request-mock";var r=Object.entries(t.mockItem.header).find((function(e){return e[0].toLowerCase()===n}));return r?r[1]:null}return e.call(t,n)}}}),this},t.prototype.interceptSetRequestHeader=function(){var e=this.xhr.setRequestHeader;return Object.defineProperty(this.xhr,"setRequestHeader",{get:function(){var t=this;return function(n,r){return t.isMockRequest?(t.requestInfo.headers=t.requestInfo.headers||{},void(t.requestInfo.headers[n]=r)):e.call(t,n,r)}}}),this},t.prototype.getGetter=function(e){var t=Object.getOwnPropertyDescriptor(this.xhr,e);return t?t.get:this.xhr[e]},t.prototype.interceptReadyState=function(){var e=this.getGetter("readyState");return Object.defineProperty(this.xhr,"readyState",{get:function(){return this.isMockRequest?this.mockResponse instanceof d?1:4:"function"==typeof e?e.call(this):e}}),this},t.prototype.interceptStatus=function(){var e=this.getGetter("status");return Object.defineProperty(this.xhr,"status",{get:function(){return this.isMockRequest?this.mockResponse instanceof d?0:this.mockItem.status:"function"==typeof e?e.call(this):e}}),this},t.prototype.interceptStatusText=function(){var e=this.getGetter("statusText");return Object.defineProperty(this.xhr,"statusText",{get:function(){return this.isMockRequest?this.mockResponse instanceof d?"":l.HTTPStatusCodes[this.mockItem.status]||"":"function"==typeof e?e.call(this):e}}),this},t.prototype.interceptResponseText=function(){var e=this.getGetter("responseText");return Object.defineProperty(this.xhr,"responseText",{get:function(){if(this.isMockRequest){if(this.mockResponse instanceof d)return"";var t=this.mockResponse;return"string"==typeof t?t:JSON.stringify(t)}return"function"==typeof e?e.call(this):e}}),this},t.prototype.interceptResponse=function(){var e=this.getGetter("response");return Object.defineProperty(this.xhr,"response",{get:function(){if(this.isMockRequest){if(this.mockResponse instanceof d)return null;var t=this.responseType;if("text"===t||""===t)return this.responseText;if("arraybuffer"===t&&"function"==typeof ArrayBuffer)return this.mockResponse instanceof ArrayBuffer?this.mockResponse:null;if("blob"===t&&"function"==typeof Blob)return this.mockResponse instanceof Blob?this.mockResponse:null;if("document"===t&&("function"==typeof Document||"function"==typeof XMLDocument))return this.mockResponse instanceof Document||this.mockResponse instanceof XMLDocument?this.mockResponse:null;if("json"===t){if("object"==typeof this.mockResponse)return this.mockResponse;if("string"==typeof this.mockResponse)try{return JSON.parse(this.mockResponse)}catch(e){return null}return null}return this.mockResponse}return"function"==typeof e?e.call(this):e}}),this},t.prototype.interceptResponseURL=function(){var e=this.getGetter("responseURL");return Object.defineProperty(this.xhr,"responseURL",{get:function(){return this.isMockRequest?this.requestInfo.url:"function"==typeof e?e.call(this):e}}),this},t.prototype.interceptResponseXML=function(){var e=this.getGetter("responseXML");return Object.defineProperty(this.xhr,"responseXML",{get:function(){return this.isMockRequest?"document"===this.responseType?this.response:null:"function"==typeof e?e.call(this):e}}),this},t}(a(n(985)).default);t.default=p;var d=function(){}},832:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(176)),u=function(){function e(e){var t;e.url&&("string"==typeof e.url||e.url instanceof RegExp)&&(this.url=e.url,this.method=/^(get|post|put|patch|delete|head|any)$/i.test(e.method||"")?null===(t=e.method)||void 0===t?void 0:t.toUpperCase():"any",this.header="object"==typeof e.header?e.header:{},this.delay=void 0!==e.delay&&/^\d{0,15}$/.test(e.delay+"")?+e.delay:0,this.times=void 0!==e.times&&/^-?\d{0,15}$/.test(e.times+"")?+e.times:1/0,this.status=e.status&&/^[1-5][0-9][0-9]$/.test(e.status+"")?+e.status:200,this.disable=e.disable&&/^(yes|true|1)$/.test(e.disable)?"YES":"NO",this.body="body"in e?e.body:"response"in e?e.response:"",this.key="".concat(this.url,"-").concat(this.method))}return e.prototype.bypass=function(){return new i.default},e.prototype.sendBody=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return"function"!=typeof this.body?[3,2]:[4,this.body.bind(this)(e,this)];case 1:return t=n.sent(),[3,3];case 2:t=this.body,n.label=3;case 3:return[2,t]}}))}))},e}();t.default=u},755:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(571),i=n(913),u=n(699),a=o(n(832)),c=function(){function e(){if(this.disabled=!1,this.log=!1,e.instance)return e.instance;e.instance=this,this.log=!(0,s.isNodejs)(),this.mockConfigData={},this.groupLog([["[http-request-mock] is %cloaded.","color:inherit;font-weight:bold;"]])}return e.getInstance=function(){return new e},e.prototype.setMockData=function(e){for(var t in e)this.mock(e[t]);return this},e.prototype.addMockItem=function(e,t){return this.mockConfigData[e]=t,this},e.prototype.reset=function(){return this.setMockData({}),this},e.prototype.enable=function(){return this.disabled=!1,this.groupLog([["[http-request-mock] is %cenabled.","color:green;font-weight:bold;"]]),this},e.prototype.disable=function(){return this.disabled=!0,this.groupLog([["[http-request-mock] is %cdisabled.","color:red;font-weight:bold;"]]),this},e.prototype.disableLog=function(){return this.log=!1,this},e.prototype.enableLog=function(){return this.log=!0,this},e.prototype.mock=function(e){if(!(0,s.isObject)(e))throw new Error("Invalid mock item, a valid mock item must be an object.");var t=new a.default(e);return!!t.key&&(this.addMockItem(t.key,t),t)},e.prototype.get=function(e,t,n){void 0===n&&(n={delay:0,status:200,times:1/0,header:{}});var r=n.delay,o=n.status,s=n.times,i=n.header;return this.mock({url:e,method:u.Method.GET,body:t,delay:r,status:o,header:i,times:s}),this},e.prototype.post=function(e,t,n){void 0===n&&(n={delay:0,status:200,times:1/0,header:{}});var r=n.delay,o=n.status,s=n.times,i=n.header;return this.mock({url:e,method:u.Method.POST,body:t,delay:r,status:o,header:i,times:s}),this},e.prototype.put=function(e,t,n){void 0===n&&(n={delay:0,status:200,times:1/0,header:{}});var r=n.delay,o=n.status,s=n.times,i=n.header;return this.mock({url:e,method:u.Method.PUT,body:t,delay:r,status:o,header:i,times:s}),this},e.prototype.patch=function(e,t,n){void 0===n&&(n={delay:0,status:200,times:1/0,header:{}});var r=n.delay,o=n.status,s=n.times,i=n.header;return this.mock({url:e,method:u.Method.PATCH,body:t,delay:r,status:o,header:i,times:s}),this},e.prototype.delete=function(e,t,n){void 0===n&&(n={delay:0,status:200,times:1/0,header:{}});var r=n.delay,o=n.status,s=n.times,i=n.header;return this.mock({url:e,method:u.Method.DELETE,body:t,delay:r,status:o,header:i,times:s}),this},e.prototype.head=function(e,t){void 0===t&&(t={delay:0,status:200,times:1/0,header:{}});var n=t.delay,r=t.status,o=t.times,s=t.header;return this.mock({url:e,method:u.Method.HEAD,body:"",delay:n,status:r,header:s,times:o}),this},e.prototype.any=function(e,t,n){void 0===n&&(n={delay:0,status:200,times:1/0,header:{}});var r=n.delay,o=n.status,s=n.times,i=n.header;return this.mock({url:e,method:u.Method.ANY,body:t,delay:r,status:o,header:i,times:s}),this},e.prototype.matchMockItem=function(e,t){if(this.disabled)return null;for(var n=(t||"GET").toUpperCase(),r=Object.values(this.mockConfigData).filter((function(e){var t=e.disable,r=e.times,o=e.method,s=String(o).toUpperCase();return"YES"!==t&&(void 0===r||r>0)&&("ANY"===s||s===n)})).sort((function(e,t){return String(t.url).length-String(e.url).length})),o=0;o<2;o++)for(var s=0,i=r;s<i.length;s++){var u=i[s];try{if(u.url instanceof RegExp&&u.url.test(e))return u;var a=0===e.indexOf("//")?String(u.url).replace(/^https?:/gi,""):String(u.url);if(0===o&&e===a)return u;if(1===o&&-1!==e.indexOf(a))return u}catch(e){}}return null},e.prototype.groupLog=function(e){if(this.log&&"function"==typeof console.groupCollapsed&&"function"==typeof console.groupEnd){Array.isArray(e[0])?console.groupCollapsed.apply(console,e[0]):console.groupCollapsed(e[0]);for(var t=1;t<e.length;t++)Array.isArray(e[t])?console.log.apply(console,e[t]):console.log(e[t]);console.groupEnd()}},e.prototype.sendResponseLog=function(e,t,n,o){var u=[["[http-request-mock] %s %s %s (%c%s%c)","".concat((0,s.currentTime)()),n.method,n.url,"color:"+(o.status<300?"green":"red"),o.status,"color:inherit"],["Request: ",n],["Response: ",{body:t,spent:e,headers:r(r({},o.header),{"x-powered-by":"http-request-mock"}),status:o.status,statusText:i.HTTPStatusCodes[o.status]||""}]];if((0,s.isNodejs)()){var a=o.url,c=o.method,f=o.delay,l=o.times,p=o.status,d=o.disable;u[3]=["MockItem:",{url:a,method:c,delay:f,times:l,status:p,disable:d}]}else u[3]=["MockItem: ",o];this.groupLog(u)},e}();t.default=c},699:(e,t)=>{var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.Disable=t.Method=void 0,(r=t.Method||(t.Method={})).GET="GET",r.POST="POST",r.PUT="PUT",r.PATCH="PATCH",r.DELETE="DELETE",r.HEAD="HEAD",r.ANY="ANY",(n=t.Disable||(t.Disable={})).YES="YES",n.NO="NO"},140:t=>{t.exports=e},799:e=>{e.exports=t},548:e=>{e.exports=o},874:e=>{e.exports=r},269:e=>{e.exports=s},638:e=>{e.exports=n}},u={};function a(e){var t=u[e];if(void 0!==t)return t.exports;var n=u[e]={exports:{}};return i[e].call(n.exports,n,n.exports,a),n.exports}a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var c=a(607);return c.default})()}));